#ifndef ROGUELIKE__FRAME_MANAGER_HPP
#define ROGUELIKE__FRAME_MANAGER_HPP

///////////////////////////////////////////////////////////////////////////////
/// Headers
///////////////////////////////////////////////////////////////////////////////
#include <list>
#include "Common.hpp"
#include <SFML/Graphics.hpp>

///////////////////////////////////////////////////////////////////////////////
/// @brief Manages the rendering of all active Frames
///////////////////////////////////////////////////////////////////////////////
class FrameManager : public Updatable, public sf::Drawable {
public:

    ///////////////////////////////////////////////////////////////////////////
    /// @brief Default constructor
    ///////////////////////////////////////////////////////////////////////////
    FrameManager() = default;

    ///////////////////////////////////////////////////////////////////////////
    /// @brief Removes an open Frame
    ///
    /// @param tag  Tag of the Frame to remove
    ///////////////////////////////////////////////////////////////////////////
    void remove(const std::string& tag);

    ///////////////////////////////////////////////////////////////////////////
    /// @brief Moves a Frame with a matching tag to the highest z-level
    ///
    /// @param tag  Tag of the Frame to move to ontop of all the others
    ///////////////////////////////////////////////////////////////////////////
    void setHighest(const std::string& tag);

    ///////////////////////////////////////////////////////////////////////////
    /// @brief Adds a new Frame to be managed
    ///
    /// @param tag      Tag of the Frame to manage
    /// @param frame    Pointer to the Frame to be managed
    ///////////////////////////////////////////////////////////////////////////
    void add(const std::string& tag, Frame* frame);

    ///////////////////////////////////////////////////////////////////////////
    /// @brief Updates all managed frames
    ///
    /// The global State instance should call this once per frame
    ///////////////////////////////////////////////////////////////////////////
    void update() override;

private:
    ///////////////////////////////////////////////////////////////////////////
    /// @brief Typedefs
    ///////////////////////////////////////////////////////////////////////////
    typedef std::pair<std::string, std::unique_ptr<Frame>> FrameHandle;

    ///////////////////////////////////////////////////////////////////////////
    /// @brief Overloaded draw function from sf::Drawable/sf::Transformable
    ///
    /// Draws all managed Frames
    ///////////////////////////////////////////////////////////////////////////
    void draw(sf::RenderTarget& target, sf::RenderStates) const override;

    ///////////////////////////////////////////////////////////////////////////
    /// @brief Returns an iterator to the first FrameHandle with a matching tag
    ///////////////////////////////////////////////////////////////////////////
    std::list<FrameHandle>::iterator getFrameIter(const std::string& tag);

    ///////////////////////////////////////////////////////////////////////////
    std::list<FrameHandle> m_frames;
};

#endif
